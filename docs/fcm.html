<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Octave Fuzzy Logic Toolkit: fcm</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" integrity="sha512-1ycn6IcaQQ40/MKBW2W4Rhis/DbILU74C1vSrLJxCq57o941Ym01SwNsOMqvEBFlcgUa6xLiPY/NS5R+E6ztJQ==" crossorigin="anonymous" referrerpolicy="no-referrer">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-U1DAWAznBHeqEIlVSCgzq+c9gqGAJn5c/t99JyeKa9xxaYpSvHU5awsuZVVFIhvj" crossorigin="anonymous"></script>
    <script type="text/javascript" async
      src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML">
    </script>
    <style>
    var {
      font-style: italics;
      font-weight: bold;
    }
    td {
      vertical-align: top;
    }
    </style>
  </head>
  <body>
    <div class="bg-dark">
      <div class="container-xl">
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
          <div class="container-fluid">
            <a class="navbar-brand" href=index.html>
              <img src="assets/fuzzy-logic-toolkit.png" alt="fuzzy-logic-toolkit" class="d-inline-block align-top" width="25" height="25">
              Octave Fuzzy Logic Toolkit
            </a>
            <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
              <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
              <ul class="navbar-nav">
                <li class="nav-item">
                  <a class="nav-link" href="index.html#Fuzzy Clustering Functions">
                    <i class="fas fa-list-alt"></i>
                    Fuzzy Clustering Functions
                  </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="https://gnu-octave.github.io/packages/">
                  <img src="assets/octave-logo.svg" alt="GNU Octave logo" class="d-inline-block align-top" width="25" height="25">
                    Octave Packages
                  </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="https://www.octave.org">
                    <i class="fas fa-home"></i>
                    GNU Octave website
                  </a>
                </li>
              </ul>
            </div>
          </div>
        </nav>
      </div>
    </div>
    <div class="container-xl my-4">
      <div class="card rounded">
        <div class="card-header card-header-mod">
          <div class="row d-flex flex-wrap align-items-center">
            <div class="col-sm-3 col-md-5 mb-2 mb-sm-0">
              <h3 class="d-inline-block mr-2">
              Function&nbsp;Reference: <b><code>fcm</code></b>
              </h3>
            </div>
          </div>
        </div>
        <div class="card-body">
<dl>
<dt><u>Function File:</u> <var>cluster_centers</var> = <b>fcm</b><i> (<var>input_data</var>, <var>num_clusters</var>)</i></dt>
<dt><u>Function File:</u> <var>cluster_centers</var> = <b>fcm</b><i> (<var>input_data</var>, <var>num_clusters</var>, <var>options</var>)</i></dt>
<dt><u>Function File:</u> <var>cluster_centers</var> = <b>fcm</b><i> (<var>input_data</var>, <var>num_clusters</var>, [<var>m</var>, <var>max_iterations</var>, <var>epsilon</var>, <var>display_intermediate_results</var>])</i></dt>
<dt><u>Function File:</u> [<var>cluster_centers</var>, <var>soft_partition</var>, <var>obj_fcn_history</var>] = <b>fcm</b><i> (<var>input_data</var>, <var>num_clusters</var>)</i></dt>
<dt><u>Function File:</u> [<var>cluster_centers</var>, <var>soft_partition</var>, <var>obj_fcn_history</var>] = <b>fcm</b><i> (<var>input_data</var>, <var>num_clusters</var>, <var>options</var>)</i></dt>
<dt><u>Function File:</u> [<var>cluster_centers</var>, <var>soft_partition</var>, <var>obj_fcn_history</var>] = <b>fcm</b><i> (<var>input_data</var>, <var>num_clusters</var>, [<var>m</var>, <var>max_iterations</var>, <var>epsilon</var>, <var>display_intermediate_results</var>])</i></dt>
</dl>

<p> Using the Fuzzy C-Means algorithm, calculate and return the soft partition
 of a set of unlabeled data points.
</p>
<div class="ms-5">
<p> Also, if <var>display_intermediate_results</var> is true, display intermediate 
 results after each iteration. Note that because the initial cluster
 prototypes are randomly selected locations in the ranges determined by the
 input data, the results of this function are nondeterministic.
</p>
<p> The required arguments to fcm are:
 </p><ul class="toc">
<li>
 <var>input_data</var> - a matrix of input data points; each row corresponds to one point
 
</li><li>
 <var>num_clusters</var> - the number of clusters to form
 
</li></ul>

<p> The optional arguments to fcm are:
 </p><ul class="toc">
<li>
 <var>m</var> - the parameter (exponent) in the objective function; default = 2.0
 
</li><li>
 <var>max_iterations</var> - the maximum number of iterations before stopping; default = 100
 
</li><li>
 <var>epsilon</var> - the stopping criteria; default = 1e-5
 
</li><li>
 <var>display_intermediate_results</var> - if 1, display results after each iteration, and if 0, do not; default = 1
 
</li></ul>

<p> The default values are used if any of the optional arguments are missing or
 evaluate to NaN.
</p>
<p> The return values are:
 </p><ul class="toc">
<li>
 <var>cluster_centers</var> - a matrix of the cluster centers; each row corresponds to one point
 
</li><li>
 <var>soft_partition</var> - a constrained soft partition matrix
 
</li><li>
 <var>obj_fcn_history</var> - the values of the objective function after each iteration
 
</li></ul>

<p> Three important matrices used in the calculation are X (the input points
 to be clustered), V (the cluster centers), and Mu (the membership of each
 data point in each cluster). Each row of X and V denotes a single point,
 and Mu(i, j) denotes the membership degree of input point X(j, :) in the
 cluster having center V(i, :).
</p>
<p> X is identical to the required argument <var>input_data</var>; V is identical
 to the output <var>cluster_centers</var>; and Mu is identical to the output
 <var>soft_partition</var>.
</p>
<p> If n denotes the number of input points and k denotes the number of
 clusters to be formed, then X, V, and Mu have the dimensions:
</p>
 <table><tr><td>&nbsp;</td><td><pre class="example"> </pre><pre class="example">                               1    2   ...  #features
                          1 [                           ]
    X  =  input_data  =   2 [                           ]
                        ... [                           ]
                          n [                           ]
 </pre><pre class="example"> </pre></td></tr></table>

 <table><tr><td>&nbsp;</td><td><pre class="example"> </pre><pre class="example">                                    1    2   ...  #features
                               1 [                           ]
    V  =  cluster_centers  =   2 [                           ]
                             ... [                           ]
                               k [                           ]
 </pre><pre class="example"> </pre></td></tr></table>

 <table><tr><td>&nbsp;</td><td><pre class="example"> </pre><pre class="example">                                    1    2   ...   n
                               1 [                    ]
    Mu  =  soft_partition  =   2 [                    ]
                             ... [                    ]
                               k [                    ]
 </pre><pre class="example"> </pre></td></tr></table>

<p> <strong>See also: </strong>
  <a href="gustafson_kessel.html">gustafson_kessel</a>, 
  <a href="partition_coeff.html">partition_coeff</a>, 
  <a href="partition_entropy.html">partition_entropy</a>, 
  <a href="xie_beni_index.html">xie_beni_index</a>
</p>
</div>
        <div class="container-xl my-4">
          <div class="card rounded">
            <div class="card-header card-header-mod">
              <div class="row d-flex flex-wrap align-items-center">
                <div class="col-sm-3 col-md-5 mb-2 mb-sm-0">
                  <h3 class="d-inline-block mr-2">
                  Example: 1
                  </h3>
                </div>
              </div>
            </div>
            <div class="card-body">
              <div class="container bg-light">
                <div class="row">
                  <table><tbody><tr>
                    <td>&nbsp;</td>
                    <td><pre class="example">

 ## This demo:
 ##    - classifies a small set of unlabeled data points using
 ##      the Fuzzy C-Means algorithm into two fuzzy clusters
 ##    - plots the input points together with the cluster centers
 ##    - evaluates the quality of the resulting clusters using
 ##      three validity measures: the partition coefficient, the
 ##      partition entropy, and the Xie-Beni validity index
 ##
 ## Note: The input_data is taken from Chapter 13, Example 17 in
 ##       Fuzzy Logic: Intelligence, Control and Information, by
 ##       J. Yen and R. Langari, Prentice Hall, 1999, page 381
 ##       (International Edition). 

 ## Use fcm to classify the input_data.
 input_data = [2 12; 4 9; 7 13; 11 5; 12 7; 14 4];
 number_of_clusters = 2;
 [cluster_centers, soft_partition, obj_fcn_history] = ...
   fcm (input_data, number_of_clusters)
 
 ## Plot the data points as small blue x's.
 figure ('NumberTitle', 'off', 'Name', 'FCM Demo 1');
 for i = 1 : rows (input_data)
   plot (input_data(i, 1), input_data(i, 2), 'LineWidth', 2, ...
         'marker', 'x', 'color', 'b');
   hold on;
 endfor

 ## Plot the cluster centers as larger red *'s.
 for i = 1 : number_of_clusters
   plot (cluster_centers(i, 1), cluster_centers(i, 2), ...
         'LineWidth', 4, 'marker', '*', 'color', 'r');
   hold on;
 endfor

 ## Make the figure look a little better:
 ##    - scale and label the axes
 ##    - show gridlines
 xlim ([0 15]);
 ylim ([0 15]);
 xlabel ('Feature 1');
 ylabel ('Feature 2');
 grid
 hold
 
 ## Calculate and print the three validity measures.
 printf ("Partition Coefficient: %f\n", ...
         partition_coeff (soft_partition));
 printf ("Partition Entropy (with a = 2): %f\n", ...
         partition_entropy (soft_partition, 2));
 printf ("Xie-Beni Index: %f\n\n", ...
         xie_beni_index (input_data, cluster_centers, ...
         soft_partition));

Iteration count = 1,  Objective fcn = 89.397281
Iteration count = 2,  Objective fcn = 59.312438
Iteration count = 3,  Objective fcn = 30.115461
Iteration count = 4,  Objective fcn = 28.766914
Iteration count = 5,  Objective fcn = 28.757517
Iteration count = 6,  Objective fcn = 28.757461
Iteration count = 7,  Objective fcn = 28.757460
Iteration count = 8,  Objective fcn = 28.757460
Iteration count = 9,  Objective fcn = 28.757460
cluster_centers =

    4.2023   11.2805
   12.2859    5.3691

soft_partition =

   0.965400   0.939806   0.888773   0.020467   0.033486   0.031290
   0.034600   0.060194   0.111227   0.979533   0.966514   0.968710

obj_fcn_history =

   89.397   59.312   30.115   28.767   28.758   28.757   28.757   28.757   28.757

hold is now off for current axes
Partition Coefficient: 0.909483
Partition Entropy (with a = 2): 0.267539
Xie-Beni Index: 0.095582

                    </pre></td></tr></tbody>
                  </table>
                  <div class="text-center">
                    <img src="assets/fcm_101.png" class="rounded img-thumbnail" alt="plotted figure">
                  </div><p></p>

                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="container-xl my-4">
          <div class="card rounded">
            <div class="card-header card-header-mod">
              <div class="row d-flex flex-wrap align-items-center">
                <div class="col-sm-3 col-md-5 mb-2 mb-sm-0">
                  <h3 class="d-inline-block mr-2">
                  Example: 2
                  </h3>
                </div>
              </div>
            </div>
            <div class="card-body">
              <div class="container bg-light">
                <div class="row">
                  <table><tbody><tr>
                    <td>&nbsp;</td>
                    <td><pre class="example">

 ## This demo:
 ##    - classifies three-dimensional unlabeled data points using
 ##      the Fuzzy C-Means algorithm into three fuzzy clusters
 ##    - plots the input points together with the cluster centers
 ##    - evaluates the quality of the resulting clusters using
 ##      three validity measures: the partition coefficient, the
 ##      partition entropy, and the Xie-Beni validity index
 ##
 ## Note: The input_data was selected to form three areas of
 ##       different shapes.
 
 ## Use fcm to classify the input_data.
 input_data = [1 11 5; 1 12 6; 1 13 5; 2 11 7; 2 12 6; 2 13 7;
               3 11 6; 3 12 5; 3 13 7; 1 1 10; 1 3 9; 2 2 11;
               3 1 9; 3 3 10; 3 5 11; 4 4 9; 4 6 8; 5 5 8; 5 7 9;
               6 6 10; 9 10 12; 9 12 13; 9 13 14; 10 9 13; 10 13 12;
               11 10 14; 11 12 13; 12 6 12; 12 7 15; 12 9 15;
               14 6 14; 14 8 13];
 number_of_clusters = 3;
 [cluster_centers, soft_partition, obj_fcn_history] = ...
   fcm (input_data, number_of_clusters, [NaN NaN NaN 0])
 
 ## Plot the data points in two dimensions (using features 1 & 2)
 ## as small blue x's.
 figure ('NumberTitle', 'off', 'Name', 'FCM Demo 2');
 for i = 1 : rows (input_data)
   plot (input_data(i, 1), input_data(i, 2), 'LineWidth', 2, ...
         'marker', 'x', 'color', 'b');
   hold on;
 endfor
 
 ## Plot the cluster centers in two dimensions
 ## (using features 1 & 2) as larger red *'s.
 for i = 1 : number_of_clusters
   plot (cluster_centers(i, 1), cluster_centers(i, 2), ...
         'LineWidth', 4, 'marker', '*', 'color', 'r');
   hold on;
 endfor
 
 ## Make the figure look a little better:
 ##    - scale and label the axes
 ##    - show gridlines
 xlim ([0 15]);
 ylim ([0 15]);
 xlabel ('Feature 1');
 ylabel ('Feature 2');
 grid
 hold
 
 ## Plot the data points in two dimensions
 ## (using features 1 & 3) as small blue x's.
 figure ('NumberTitle', 'off', 'Name', 'FCM Demo 2');
 for i = 1 : rows (input_data)
   plot (input_data(i, 1), input_data(i, 3), 'LineWidth', 2, ...
         'marker', 'x', 'color', 'b');
   hold on;
 endfor
 
 ## Plot the cluster centers in two dimensions
 ## (using features 1 & 3) as larger red *'s.
 for i = 1 : number_of_clusters
   plot (cluster_centers(i, 1), cluster_centers(i, 3), ...
         'LineWidth', 4, 'marker', '*', 'color', 'r');
   hold on;
 endfor
 
 ## Make the figure look a little better:
 ##    - scale and label the axes
 ##    - show gridlines
 xlim ([0 15]);
 ylim ([0 15]);
 xlabel ('Feature 1');
 ylabel ('Feature 3');
 grid
 hold
 
 ## Calculate and print the three validity measures.
 printf ("Partition Coefficient: %f\n", ...
         partition_coeff (soft_partition));
 printf ("Partition Entropy (with a = 2): %f\n", ...
         partition_entropy (soft_partition, 2));
 printf ("Xie-Beni Index: %f\n\n", ...
         xie_beni_index (input_data, cluster_centers, ...
         soft_partition));

cluster_centers =

   11.0424    9.5332   13.3569
    2.0937   11.9016    6.0942
    3.1989    3.6232    9.5521

soft_partition =

 Columns 1 through 6:

   1.7523e-02   7.3841e-03   1.8740e-02   1.2705e-02   1.9250e-04   1.4638e-02
   9.4461e-01   9.7904e-01   9.5109e-01   9.6197e-01   9.9948e-01   9.6487e-01
   3.7871e-02   1.3572e-02   3.0172e-02   2.5327e-02   3.2448e-04   2.0488e-02

 Columns 7 through 12:

   1.3086e-02   1.3915e-02   2.3066e-02   5.5911e-02   3.1032e-02   3.9162e-02
   9.6332e-01   9.6457e-01   9.4834e-01   7.6424e-02   5.6743e-02   4.6202e-02
   2.3598e-02   2.1516e-02   2.8592e-02   8.6766e-01   9.1223e-01   9.1464e-01

 Columns 13 through 18:

   4.1879e-02   5.2361e-03   4.0373e-02   1.0700e-02   7.3581e-02   7.2479e-02
   5.1153e-02   6.5170e-03   5.0542e-02   1.4244e-02   1.5867e-01   1.0410e-01
   9.0697e-01   9.8825e-01   9.0909e-01   9.7506e-01   7.6774e-01   8.2343e-01

 Columns 19 through 24:

   1.5029e-01   1.8715e-01   8.6967e-01   8.3432e-01   7.8958e-01   9.7102e-01
   2.2741e-01   1.4085e-01   6.2864e-02   9.0815e-02   1.1768e-01   1.2265e-02
   6.2230e-01   6.7200e-01   6.7469e-02   7.4870e-02   9.2741e-02   1.6712e-02

 Columns 25 through 30:

   7.9477e-01   9.9052e-01   9.1541e-01   7.9248e-01   8.8149e-01   9.5269e-01
   1.2048e-01   4.3134e-03   4.4784e-02   7.1964e-02   4.3901e-02   1.9996e-02
   8.4745e-02   5.1715e-03   3.9804e-02   1.3556e-01   7.4614e-02   2.7318e-02

 Columns 31 and 32:

   8.0460e-01   8.8430e-01
   7.2840e-02   4.8500e-02
   1.2256e-01   6.7204e-02

obj_fcn_history =

 Columns 1 through 9:

   478.00   367.56   314.02   241.80   186.69   181.30   180.71   180.62   180.61

 Columns 10 through 18:

   180.61   180.61   180.61   180.61   180.61   180.61   180.61   180.61   180.61

hold is now off for current axes
hold is now off for current axes
Partition Coefficient: 0.813224
Partition Entropy (with a = 2): 0.541401
Xie-Beni Index: 0.207218

                    </pre></td></tr></tbody>
                  </table>
                  <div class="text-center">
                    <img src="assets/fcm_202.png" class="rounded img-thumbnail" alt="plotted figure">
                  </div><p></p>
                  <div class="text-center">
                    <img src="assets/fcm_201.png" class="rounded img-thumbnail" alt="plotted figure">
                  </div><p></p>

                </div>
              </div>
            </div>
          </div>
        </div>


        </div>
      </div>
    </div>

  </body>
</html>
